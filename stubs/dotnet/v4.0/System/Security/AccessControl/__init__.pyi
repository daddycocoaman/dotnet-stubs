from typing import Tuple, Set, Iterable, List


class SemaphoreAccessRule(AccessRule):
    @overload
    def __init__(self, identity: IdentityReference, eventRights: SemaphoreRights, type: AccessControlType): ...
    @overload
    def __init__(self, identity: str, eventRights: SemaphoreRights, type: AccessControlType): ...
    @property
    def SemaphoreRights(self) -> SemaphoreRights: ...


class SemaphoreAuditRule(AuditRule):
    def __init__(self, identity: IdentityReference, eventRights: SemaphoreRights, flags: AuditFlags): ...
    @property
    def SemaphoreRights(self) -> SemaphoreRights: ...


class SemaphoreRights:
    Modify = 2
    Delete = 65536
    ReadPermissions = 131072
    ChangePermissions = 262144
    TakeOwnership = 524288
    Synchronize = 1048576
    FullControl = 2031619


class SemaphoreSecurity(NativeObjectSecurity):
    @overload
    def __init__(self): ...
    @overload
    def __init__(self, name: str, includeSections: AccessControlSections): ...
    def AccessRuleFactory(self, identityReference: IdentityReference, accessMask: int, isInherited: bool, inheritanceFlags: InheritanceFlags, propagationFlags: PropagationFlags, type: AccessControlType) -> AccessRule: ...
    def AddAccessRule(self, rule: SemaphoreAccessRule) -> None: ...
    def AddAuditRule(self, rule: SemaphoreAuditRule) -> None: ...
    def AuditRuleFactory(self, identityReference: IdentityReference, accessMask: int, isInherited: bool, inheritanceFlags: InheritanceFlags, propagationFlags: PropagationFlags, flags: AuditFlags) -> AuditRule: ...
    @property
    def AccessRightType(self) -> Type: ...
    @property
    def AccessRuleType(self) -> Type: ...
    @property
    def AuditRuleType(self) -> Type: ...
    def RemoveAccessRule(self, rule: SemaphoreAccessRule) -> bool: ...
    def RemoveAccessRuleAll(self, rule: SemaphoreAccessRule) -> None: ...
    def RemoveAccessRuleSpecific(self, rule: SemaphoreAccessRule) -> None: ...
    def RemoveAuditRule(self, rule: SemaphoreAuditRule) -> bool: ...
    def RemoveAuditRuleAll(self, rule: SemaphoreAuditRule) -> None: ...
    def RemoveAuditRuleSpecific(self, rule: SemaphoreAuditRule) -> None: ...
    def ResetAccessRule(self, rule: SemaphoreAccessRule) -> None: ...
    def SetAccessRule(self, rule: SemaphoreAccessRule) -> None: ...
    def SetAuditRule(self, rule: SemaphoreAuditRule) -> None: ...
